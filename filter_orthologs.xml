<tool id="divergence_filter_orthologs" name="Filter orthologs">
    <description>to only retain orthologs suitable for further analysis</description>
    <requirements>
        <requirement type="python-module">divergence</requirement>
    </requirements>
    <command interpreter="python">wrapper.py divergence.filter_orthologs $logfile
--orthologs-zip $dnazip
$filtermultiplecogs
#if $recombinedzip
--filter-recombination $recombinedzip
--taxon-a $genomesa
--taxon-a $genomesb
#end if
--retained-zip $retainedzip
</command>
    <inputs>
        <param format="zip" name="dnazip" type="data" label="Orthologous genes" />
        <param name="filtermultiplecogs" type="boolean" label="Filter multiple COGs" checked="true" truevalue="--filter-multiple-cogs" falsevalue="">
            <help>Filter orthologs where multiple different COGs are assigned to various strains</help>
        </param>
        <conditional name="filterconditional">
	        <param name="filterrecombination" type="select" label="Filter recombination" display="radio">
	            <help>Filter orthologs where there is evidence of recombination within an ortholog based upon phylogenetic tree inspection</help>
	            <option value="yes" selected="true">Yes</option>
	            <option value="no">No</option>
	        </param>
			<when value="yes">
				<param format="tabular" name="genomesa" type="data" label="Taxon A RefSeq project IDs file" optional="true"/>
				<param format="tabular" name="genomesb" type="data" label="Taxon B RefSeq project IDs file" optional="true"/>
			</when>
			<when value="no" />
        </conditional>
    </inputs>
    <outputs>
        <data format="txt" name="logfile" label="Logfile for ${tool.name}" />
        <data format="zip" name="recombinedzip" label="Recombination orthologs">
            <filter>(filterconditional['filterrecombination'] == 'yes')</filter>
        </data>
        <data format="zip" name="retainedzip" label="Retained orthologs" />
    </outputs>
    <help>
This tool allows you to filter out orthologs in a number of different ways, as detailed above.

This tool will carry over 'missing' COG annotations within ortholog files if "Filter multiple COGs" is enabled.
  </help>
</tool>
